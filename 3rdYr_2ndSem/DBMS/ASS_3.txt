create table department_ass3(
	dept_code char(10) primary key,
	dept_name char(30));

create table employee_ass3
	(emp_code char(10) primary key,
	dept_code char(10),
	emp_name char(30) constraint upper_case_name check (emp_name=upper(emp_name)),
	address char(50), 
	dt_jn date default sysdate,
	grade char(1) constraint grade_valid check (grade in ('A','B','C')), 
	basic number(7,2) constraint sal_chk check (basic>= 5000 and basic<=9000),
	constraint dept_fkey foreign key(dept_code) references department_ass3(dept_code)
	);

create table leave_ass3(
	emp_code char(10),
	type char(2) constraint valid_type check(type in('CL','EL','ML')), 
	from_dt date, to_dt date,
	foreign key(emp_code) references employee_ass3(emp_code),
	primary key(emp_code, type)
	);

create table personnel_ass3(
	emp_code primary key,
	emp_name,
	dept_name,
	basic)
as select emp_code, emp_name, dept_name, basic from employee_ass3,
	department_ass3 where employee_ass3.dept_code=department_ass3.dept_code
	and basic=7000 and department_ass3.dept_code='D3';

insert into personnel_ass3
	select emp_code, emp_name, dept_name, basic from employee_ass3,
	department_ass3 where employee_ass3.dept_code=department_ass3.dept_code
	and basic>=7000
	and emp_code not in (select distinct emp_code from personnel_ass3);

alter table personnel_ass3 add (net_pay number(9,2));
update personnel_ass3 set net_pay=1.5*basic;
alter table personnel_ass3 drop column net_pay;

